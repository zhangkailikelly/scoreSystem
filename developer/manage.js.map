{"version":3,"sources":["manage.jsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AACA,IAAI,OAAO;AACP,UAAM,CACF,EAAC,MAAM,IAAP,EAAa,QAAQ,CAArB,EAAwB,OAAO,SAA/B,EADE,EAEF,EAAC,MAAM,IAAP,EAAa,QAAQ,CAArB,EAAwB,OAAO,SAA/B,EAFE,EAGF,EAAC,MAAM,IAAP,EAAa,QAAQ,CAArB,EAAwB,OAAO,SAA/B,EAHE,EAIF,EAAC,MAAM,IAAP,EAAa,QAAQ,CAArB,EAAwB,OAAO,SAA/B,EAJE,EAKF,EAAC,MAAM,IAAP,EAAa,QAAQ,CAArB,EAAwB,OAAO,SAA/B,EALE,EAMF,EAAC,MAAM,IAAP,EAAa,QAAQ,CAArB,EAAwB,OAAO,SAA/B,EANE,EAOF,EAAC,MAAM,IAAP,EAAa,QAAQ,CAArB,EAAwB,OAAO,SAA/B,EAPE,EAQF,EAAC,MAAM,IAAP,EAAa,QAAQ,CAArB,EAAwB,OAAO,SAA/B,EARE,EASF,EAAC,MAAM,IAAP,EAAa,QAAQ,CAArB,EAAwB,OAAO,SAA/B,EATE,EAUF,EAAC,MAAM,KAAP,EAAc,QAAQ,CAAtB,EAAyB,OAAO,SAAhC,EAVE,EAWF,EAAC,MAAM,KAAP,EAAc,QAAQ,CAAtB,EAAyB,OAAO,SAAhC,EAXE,EAYF,EAAC,MAAM,KAAP,EAAc,QAAQ,CAAtB,EAAyB,OAAO,SAAhC,EAZE,CADC;AAeP,eAAW,GAfJ;AAgBP,WAAO,QAhBA;AAiBP,UAAM;AAjBC,CAAX;;;;;;;;;;;;;6CAqByB;AACjB,iBAAK,KAAL,GAAa;AACT;AACA,sBAAM,KAAK,IAFF;AAGT,2BAAW,KAAK,SAHP;AAIT,uBAAO,KAAK,KAJH;AAKT,qBAAK;;AALI,aAAb;AAQH;;;4CAEmB;AAChB;AACA,gBAAI,QAAQ,IAAZ;AACA,cAAE,IAAF,CAAO;AACH,qBAAK,SADF;AAEH,sBAAM,KAFH;AAGH,yBAAS,iBAAU,KAAV,EAAiB;AACtB,wBAAI,KAAJ,EAAW;AACP,4BAAI,SAAS,OAAO,MAAP,CAAc,EAAd,EAAkB,IAAlB,EAAwB,KAAxB,CAAb;AACA,8BAAM,QAAN,CAAe,MAAf,EAFO,CAEgB;AACvB,8BAAM,IAAN,CAAW,KAAX,CAAiB,KAAjB,GAAyB,OAAO,KAAhC;AACA,8BAAM,IAAN,CAAW,SAAX,CAAqB,KAArB,GAA6B,OAAO,SAApC;AACH,qBALD,MAMK;AACD,8BAAM,IAAN,CAAW,KAAX,CAAiB,KAAjB,GAAyB,MAAM,KAAN,CAAY,KAArC;AACA,8BAAM,IAAN,CAAW,SAAX,CAAqB,KAArB,GAA6B,MAAM,KAAN,CAAY,SAAzC;AACA,8BAAM,KAAN,CAAY,CAAZ,EAHC,CAGc;AAClB;AACJ;AAfE,aAAP;AAiBH;;;+BAEM,I,EAAM;AACT;AACA;AACA,gBAAI,QAAQ,EAAE,YAAF,CAAZ;AACA,gBAAI,UAAU,EAAd;AACA,iBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,KAAL,CAAW,IAAX,CAAgB,MAApC,EAA4C,GAA5C,EAAiD;AAC7C,wBAAQ,CAAR,IAAa,EAAb;AACA,qBAAK,IAAI,GAAT,IAAgB,KAAK,KAAL,CAAW,IAAX,CAAgB,CAAhB,CAAhB,EAAoC;AAChC,wBAAI,OAAO,QAAX,EAAqB;AACjB,gCAAQ,CAAR,EAAW,GAAX,IAAkB,EAAE,MAAM,CAAN,CAAF,EAAY,IAAZ,EAAlB;AACH,qBAFD,MAEO;AACH,gCAAQ,CAAR,EAAW,GAAX,IAAkB,KAAK,KAAL,CAAW,IAAX,CAAgB,CAAhB,EAAmB,GAAnB,CAAlB;AACH;AACJ;AACJ;AACD,gBAAI,QAAQ,CAAZ,EAAe;AACX;AACA,wBAAQ,IAAR,CAAa,UAAU,CAAV,EAAa,CAAb,EAAgB;AACzB,2BAAO,EAAE,MAAF,GAAW,EAAE,MAApB;AACH,iBAFD;AAGH,aALD,MAKO;AACH,uBAAO,CAAP;AACH;AACD;AACA,iBAAK,QAAL,CAAc;AACV,sBAAM;AADI,aAAd;AAGA,gBAAI,eAAe;AACf,sBAAM,KAAK,SAAL,CAAe;AACjB,0BAAM,OADW;AAEjB,0BAAM,IAFW;AAGjB,yBAAK,IAHY;AAIjB,2BAAO,KAAK,KAAL,CAAW,KAJD;AAKjB,+BAAW,KAAK,KAAL,CAAW;AALL,iBAAf;AADS,aAAnB;AASA,cAAE,IAAF,CAAO;AACH,qBAAK,SADF;AAEH,sBAAM,YAFH;AAGH,sBAAM,MAHH;AAIH,yBAAS,iBAAU,IAAV,EAAgB;AACrB,wBAAI,IAAJ,EAAU;AACN,8BAAM,QAAN;AACH;AACJ;AARE,aAAP;AAUH;;;+BAEM;AACH,iBAAK,MAAL,CAAY,CAAZ;AACH;;;8BAEK,G,EAAK;AACP;AACA,gBAAI,QAAQ,EAAE,qBAAF,CAAZ,CAFO,CAE6B;AACpC,gBAAI,SAAS,EAAE,sBAAF,CAAb,CAHO,CAG+B;AACtC,gBAAI,OAAO,EAAX,CAJO,CAIO;AACd,iBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,MAAM,MAA1B,EAAkC,GAAlC,EAAuC;AACnC,qBAAK,CAAL,IAAU,EAAV;AACA,qBAAK,CAAL,EAAQ,IAAR,GAAe,EAAE,MAAM,CAAN,CAAF,EAAY,GAAZ,GAAkB,IAAlB,KAA2B,EAAE,MAAM,CAAN,CAAF,EAAY,GAAZ,GAAkB,IAAlB,EAA3B,GAAsD,KAAK,IAAL,CAAU,CAAV,EAAa,IAAlF;AACA,qBAAK,CAAL,EAAQ,KAAR,GAAgB,EAAE,OAAO,CAAP,CAAF,EAAa,GAAb,KAAqB,EAAE,OAAO,CAAP,CAAF,EAAa,GAAb,EAArB,GAA0C,KAAK,IAAL,CAAU,CAAV,EAAa,KAAvE;AACA,qBAAK,CAAL,EAAQ,MAAR,GAAiB,CAAjB;AACH;AACD;AACA,gBAAI,MAAM,EAAV;AACA,gBAAI,IAAJ,GAAW,IAAX;AACA,gBAAI,IAAJ,GAAW,CAAX;AACA;AACA,gBAAI,GAAJ,GAAU,CAAV;AACA,gBAAI,GAAJ,GAAU,KAAK,KAAL,CAAW,GAArB;AACA,gBAAI,KAAJ,GAAY,KAAK,IAAL,CAAU,KAAV,CAAgB,KAAhB,GAAwB,KAAK,IAAL,CAAU,KAAV,CAAgB,KAAxC,GAAgD,KAAK,KAAjE;AACA,gBAAI,SAAJ,GAAgB,KAAK,IAAL,CAAU,SAAV,CAAoB,KAApB,GAA4B,KAAK,IAAL,CAAU,SAAV,CAAoB,KAAhD,GAAwD,KAAK,SAA7E;AACA,gBAAI,SAAS,OAAO,MAAP,CAAc,EAAd,EAAkB,IAAlB,EAAwB,GAAxB,CAAb;AACA,iBAAK,QAAL,CAAc,MAAd;AACA,iBAAK,IAAL,CAAU,KAAV,CAAgB,KAAhB,GAAwB,EAAE,KAAK,IAAL,CAAU,KAAZ,EAAmB,GAAnB,GAAyB,IAAzB,KAAkC,EAAE,KAAK,IAAL,CAAU,KAAZ,EAAmB,GAAnB,GAAyB,IAAzB,EAAlC,GAAoE,KAAK,KAAjG;AACA,iBAAK,IAAL,CAAU,SAAV,CAAoB,KAApB,GAA4B,CAAC,EAAE,KAAK,IAAL,CAAU,SAAZ,EAAuB,GAAvB,KAA+B,EAAhC,EAAoC,IAApC,KAA6C,CAAC,EAAE,KAAK,IAAL,CAAU,SAAZ,EAAuB,GAAvB,KAA+B,EAAhC,EAAoC,IAApC,EAA7C,GAA0F,KAAK,SAA3H;AACA,gBAAI,YAAY,EAAC,MAAM,KAAK,SAAL,CAAe,MAAf,CAAP,EAAhB;AACA,cAAE,IAAF,CAAO;AACH,qBAAK,SADF;AAEH,sBAAM,SAFH;AAGH,sBAAM,MAHH;AAIH,yBAAS,iBAAU,IAAV,EAAgB;AACrB,wBAAI,QAAQ,OAAO,CAAnB,EAAsB;AAClB,8BAAM,MAAN;AACH;AACJ;AARE,aAAP;AAUH;;;kCAES,C,EAAG;AACT,gBAAI,EAAE,MAAF,CAAS,KAAT,GAAiB,CAArB,EAAwB;AACpB,kBAAE,MAAF,CAAS,KAAT,GAAiB,EAAjB;AACH;AACJ;;;+BAEM;AACH,gBAAI,QAAQ,IAAZ;AACA,gBAAI,KAAK,IAAL,CAAU,IAAV,CAAe,KAAf,IAAwB,KAAK,IAAL,CAAU,IAAV,CAAe,KAAf,CAAqB,CAArB,CAA5B,EAAqD;AACjD,oBAAI,OAAO,IAAI,UAAJ,EAAX;AACA,qBAAK,aAAL,CAAmB,KAAK,IAAL,CAAU,IAAV,CAAe,KAAf,CAAqB,CAArB,CAAnB;AACA,qBAAK,MAAL,GAAc,UAAU,CAAV,EAAa;AACvB,0BAAM,QAAN,CAAe;AACX,6BAAK,EAAE,MAAF,CAAS;AADH,qBAAf;AAGH,iBAJD;AAKH;AAEJ;;;iCAEQ;AAAA;;AACL,mBAAQ;AAAA;AAAA,kBAAK,OAAO,EAAC,eAAe,OAAhB,EAAZ;AACJ;AAAA;AAAA,sBAAI,OAAO,EAAC,WAAW,MAAZ,EAAoB,aAAa,OAAjC,EAAX;AAAA;AAAA,iBADI;AAEJ;AAAA;AAAA,sBAAI,WAAU,OAAd,EAAsB,OAAO,EAAC,YAAY,MAAb,EAA7B;AACK,yBAAK,KAAL,CAAW,IAAX,CAAgB,GAAhB,CAAoB,UAAC,CAAD,EAAI,CAAJ,EAAS;AAC1B,4BAAI,MAAM,OAAO,MAAP,CAAc,EAAd,EAAkB,EAAC,KAAK,CAAN,EAAS,WAAW,OAAK,KAAL,CAAW,SAA/B,EAAlB,EAA6D,CAA7D,CAAV;AACA,+BAAO,+CAAW,GAAX,CAAP;AACH,qBAHA;AADL,iBAFI;AAQJ;AAAA;AAAA,sBAAK,OAAO,EAAC,OAAO,OAAR,EAAZ;AACI,6DAAO,KAAI,OAAX,EAAmB,cAAc,KAAK,KAAL,CAAW,KAA5C,EAAmD,MAAK,MAAxD;AACO,+BAAO,EAAC,YAAY,MAAb,EAAqB,WAAW,QAAhC,EADd,EACyD,aAAY,kDADrE,GADJ;AAGI,6DAAO,KAAI,WAAX,EAAuB,cAAc,KAAK,KAAL,CAAW,SAAhD,EAA2D,MAAK,QAAhE;AACO,kCAAU,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CADjB;AAEO,+BAAO,EAAC,OAAO,OAAR,EAAiB,YAAY,OAA7B,EAAsC,WAAW,QAAjD,EAFd,EAE0E,KAAI,GAF9E;AAGO,qCAAY,4CAHnB,GAHJ;AAOI;AAAA;AAAA,0BAAQ,OAAO,EAAC,YAAY,MAAb,EAAqB,WAAW,MAAhC,EAAf;AACQ,qCAAS,KAAK,MAAL,CAAY,IAAZ,CAAiB,IAAjB,CADjB;AAEQ,qCAAQ,SAFhB;AAAA;AAAA,qBAPJ;AAUI;AAAA;AAAA,0BAAQ,OAAO,EAAC,YAAY,MAAb,EAAqB,WAAW,MAAhC,EAAf;AACQ,qCAAS,KAAK,IAAL,CAAU,IAAV,CAAe,IAAf,CADjB;AAEQ,qCAAQ,SAFhB;AAAA;AAAA,qBAVJ;AAaI;AAAA;AAAA,0BAAQ,OAAO,EAAC,YAAY,MAAb,EAAqB,WAAW,MAAhC,EAAf;AACQ,qCAAS,KAAK,KAAL,CAAW,IAAX,CAAgB,IAAhB,CADjB;AAEQ,qCAAQ,SAFhB;AAAA;AAAA;AAbJ;AARI,aAAR;AA8BH;;;;EA9KgB,gBAAM,S;;AAgL3B,IAAI,OAAO,SAAS,cAAT,CAAwB,MAAxB,CAAX;;AAEA,mBAAS,MAAT,CAAgB,8BAAC,MAAD,OAAhB,EAA2B,IAA3B;AACA,CAAC;;;;;;;;;;;;;;;AAeA","file":"manage.js","sourcesContent":["import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport Input from \"./Input.jsx\";\r\nimport {Button} from \"react-bootstrap\"\r\nimport \"./base.css\";\r\n//打分端初始化数据\r\nvar Init = {\r\n    list: [\r\n        {name: \"1队\", scores: 0, color: \"#000000\"},\r\n        {name: \"2队\", scores: 0, color: \"#000000\"},\r\n        {name: \"3队\", scores: 0, color: \"#000000\"},\r\n        {name: \"4队\", scores: 0, color: \"#000000\"},\r\n        {name: \"5队\", scores: 0, color: \"#000000\"},\r\n        {name: \"6队\", scores: 0, color: \"#000000\"},\r\n        {name: \"7队\", scores: 0, color: \"#000000\"},\r\n        {name: \"8队\", scores: 0, color: \"#000000\"},\r\n        {name: \"9队\", scores: 0, color: \"#000000\"},\r\n        {name: \"10队\", scores: 0, color: \"#000000\"},\r\n        {name: \"11队\", scores: 0, color: \"#000000\"},\r\n        {name: \"12队\", scores: 0, color: \"#000000\"}\r\n    ],\r\n    maxScores: 100,\r\n    title: \"比赛打分系统\",\r\n    sort: 0\r\n};\r\n\r\nclass Manage extends React.Component {\r\n    componentWillMount() {\r\n        this.state = {\r\n            // src: \"\",\r\n            list: Init.list,\r\n            maxScores: Init.maxScores,\r\n            title: Init.title,\r\n            win: 0\r\n\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        //服务端数据同步\r\n        var _this = this;\r\n        $.ajax({\r\n            url: \"/update\",\r\n            type: \"get\",\r\n            success: function (datas) {\r\n                if (datas) {\r\n                    var newObj = Object.assign({}, Init, datas)\r\n                    _this.setState(newObj);//更新状态\r\n                    _this.refs.title.value = newObj.title;\r\n                    _this.refs.maxScores.value = newObj.maxScores;\r\n                }\r\n                else {\r\n                    _this.refs.title.value = _this.state.title;\r\n                    _this.refs.maxScores.value = _this.state.maxScores;\r\n                    _this.reset(0);//初始化数据，颜色，title，队名，最高分数\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    result(bool) {\r\n        //只更新分数\r\n        //与当前的状态进行合并\r\n        var spans = $(\"ul>li>span\");\r\n        var newList = [];\r\n        for (var i = 0; i < this.state.list.length; i++) {\r\n            newList[i] = {};\r\n            for (var key in this.state.list[i]) {\r\n                if (key == \"scores\") {\r\n                    newList[i][key] = $(spans[i]).html()\r\n                } else {\r\n                    newList[i][key] = this.state.list[i][key]\r\n                }\r\n            }\r\n        }\r\n        if (bool == 1) {\r\n            //排序\r\n            newList.sort(function (x, y) {\r\n                return y.scores - x.scores\r\n            })\r\n        } else {\r\n            bool = 0;\r\n        }\r\n        //更新状态\r\n        this.setState({\r\n            list: newList\r\n        })\r\n        var updateScores = {\r\n            data: JSON.stringify({\r\n                list: newList,\r\n                sort: bool,\r\n                win: bool,\r\n                title: this.state.title,\r\n                maxScores: this.state.maxScores\r\n            })\r\n        };\r\n        $.ajax({\r\n            url: \"/scores\",\r\n            data: updateScores,\r\n            type: \"post\",\r\n            success: function (data) {\r\n                if (data) {\r\n                    alert(\"数据更新成功\")\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    sort() {\r\n        this.result(1);\r\n    }\r\n\r\n    reset(num) {\r\n        //重置颜色，队名,最高分数，title\r\n        var names = $(\"ul input[type=text]\")//所有name\r\n        var colors = $(\"ul input[type=color]\")//所有color\r\n        var arrs = [];//新的Init.list,Init.list为默认值\r\n        for (var j = 0; j < names.length; j++) {\r\n            arrs[j] = {};\r\n            arrs[j].name = $(names[j]).val().trim() ? $(names[j]).val().trim() : Init.list[j].name\r\n            arrs[j].color = $(colors[j]).val() ? $(colors[j]).val() : Init.list[j].color\r\n            arrs[j].scores = 0\r\n        }\r\n        //新的最大分数，title\r\n        var obj = {};\r\n        obj.list = arrs;\r\n        obj.sort = 1;\r\n        //小标题是否隐藏\r\n        obj.win = 0;\r\n        obj.src = this.state.src;\r\n        obj.title = this.refs.title.value ? this.refs.title.value : Init.title;\r\n        obj.maxScores = this.refs.maxScores.value ? this.refs.maxScores.value : Init.maxScores;\r\n        var newObj = Object.assign({}, Init, obj);\r\n        this.setState(newObj);\r\n        this.refs.title.value = $(this.refs.title).val().trim() ? $(this.refs.title).val().trim() : Init.title;\r\n        this.refs.maxScores.value = ($(this.refs.maxScores).val() + \"\").trim() ? ($(this.refs.maxScores).val() + \"\").trim() : Init.maxScores;\r\n        var resetData = {data: JSON.stringify(newObj)};\r\n        $.ajax({\r\n            url: \"/scores\",\r\n            data: resetData,\r\n            type: \"post\",\r\n            success: function (data) {\r\n                if (data && num != 0) {\r\n                    alert(\"重置成功\")\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    maxScores(e) {\r\n        if (e.target.value < 5) {\r\n            e.target.value = \"\";\r\n        }\r\n    }\r\n\r\n    file() {\r\n        var _this = this;\r\n        if (this.refs.file.files && this.refs.file.files[0]) {\r\n            var read = new FileReader();\r\n            read.readAsDataURL(this.refs.file.files[0]);\r\n            read.onload = function (e) {\r\n                _this.setState({\r\n                    src: e.target.result\r\n                })\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    render() {\r\n        return (<div style={{paddingBottom: \"100px\"}}>\r\n            <h1 style={{textAlign: \"left\", paddingLeft: \"125px\"}}>比赛打分控制端</h1>\r\n            <ul className=\"clear\" style={{paddingTop: \"50px\"}}>\r\n                {this.state.list.map((v, i)=> {\r\n                    var obj = Object.assign({}, {key: i, maxScores: this.state.maxScores}, v);\r\n                    return <Input {...obj}/>\r\n                })}\r\n            </ul>\r\n            <div style={{width: \"600px\"}}>\r\n                <input ref=\"title\" defaultValue={this.state.title} type=\"text\"\r\n                       style={{marginLeft: \"92px\", textAlign: \"center\"}} placeholder=\"请输入显示端标题\"/>\r\n                <input ref=\"maxScores\" defaultValue={this.state.maxScores} type=\"number\"\r\n                       onChange={this.maxScores.bind(this)}\r\n                       style={{width: \"120px\", marginLeft: \"133px\", textAlign: \"center\"}} min=\"0\"\r\n                       placeholder=\"设定分数最大值\"/>\r\n                <Button style={{marginLeft: \"92px\", marginTop: \"20px\"}}\r\n                        onClick={this.result.bind(this)}\r\n                        bsStyle=\"success\">更新分数</Button>\r\n                <Button style={{marginLeft: \"80px\", marginTop: \"20px\"}}\r\n                        onClick={this.sort.bind(this)}\r\n                        bsStyle=\"success\">更新分数并排序</Button>\r\n                <Button style={{marginLeft: \"80px\", marginTop: \"20px\"}}\r\n                        onClick={this.reset.bind(this)}\r\n                        bsStyle=\"success\">重 置</Button>\r\n                {/*<form id='form' accept=\"image/*\" encType=\"application\">*/}\r\n                    {/*<input type=\"file\" ref=\"file\"  onChange={this.file.bind(this)}/>*/}\r\n                {/*</form>*/}\r\n                {/*<img src={this.state.src} alt=\"\" style={{width: \"100px\"}}/>*/}\r\n            </div>\r\n        </div>)\r\n    }\r\n}\r\nvar root = document.getElementById('main');\r\n\r\nReactDOM.render(<Manage/>, root);\r\n{/*\r\n API\r\n {data:{\r\n list:[{\r\n color:\"16进制颜色值\",\r\n name:\"队名\",\r\n socers:\"分数\"\r\n }],\r\n title:\"标题\",\r\n maxScores:0,\r\n sort:0/1,\r\n reset:underfined/1    }\r\n }\r\n\r\n */\r\n}"]}